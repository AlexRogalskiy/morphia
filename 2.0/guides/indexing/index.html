<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.49" />
    <meta name="description" content="">


    <link rel="shortcut icon" href="/2.0/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/2.0/images/favicon.png" type="image/x-icon" />
    <title>Indexing :: Morphia</title>

    
    <link href="/2.0/css/nucleus.css?1583121132" rel="stylesheet">
    <link href="/2.0/css/fontawesome-all.min.css?1583121132" rel="stylesheet">
    <link href="/2.0/css/hybrid.css?1583121132" rel="stylesheet">
    <link href="/2.0/css/featherlight.min.css?1583121132" rel="stylesheet">
    <link href="/2.0/css/perfect-scrollbar.min.css?1583121132" rel="stylesheet">
    <link href="/2.0/css/auto-complete.css?1583121132" rel="stylesheet">
    <link href="/2.0/css/theme.css?1583121132" rel="stylesheet">
    <link href="/2.0/css/hugo-theme.css?1583121132" rel="stylesheet">
    

    <script src="/2.0/js/jquery-2.x.min.js?1583121132"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    <link href="/2.0/css/java.css" rel="stylesheet">
<link href="/2.0/css/theme-green.css" rel="stylesheet">

<style>
    :root {
        --MAIN-TEXT-color:#004042;  
        --MAIN-TITLES-TEXT-color: #004042;  
        --MAIN-LINK-color:#006cbc;  
        --MAIN-LINK-HOVER-color:#3f6d2c;  
        --MAIN-ANCHOR-color: #599a3e;  

        --MENU-HEADER-BG-color:#004042;  
        --MENU-HEADER-BORDER-color:#6ca439;  

        --MENU-SEARCH-BG-color:#006264;  
        --MENU-SEARCH-BOX-color: #84c767;  
        --MENU-SEARCH-BOX-ICONS-color: #c7f7c4;  

        --MENU-SECTIONS-ACTIVE-BG-color:#1b211c;  
        --MENU-SECTIONS-BG-color:#222723;  
        --MENU-SECTIONS-LINK-color: #ccc;  
        --MENU-SECTIONS-LINK-HOVER-color: #e6e6e6;   
        --MENU-SECTION-ACTIVE-CATEGORY-color: #777;  
        --MENU-SECTION-ACTIVE-CATEGORY-BG-color: #f3f4eb;  

        --MENU-VISITED-color: #599a3e;  
        --MENU-SECTION-HR-color: #18211c;  
    }

    body {
        background-color: var(--MENU-SECTION-ACTIVE-CATEGORY-BG-color);
        padding-top: 0;
    }

    h1 {
        color: var(--MAIN-TITLES-TEXT-color) !important;
    }

    strong {
        color: var(--MAIN-TITLES-TEXT-color) !important;
    }

    #top-bar-sticky-wrapper {
        visibility: hidden !important;
        min-height: 0;
    }

</style>

  </head>
  <body class="" data-url="/2.0/guides/indexing/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/2.0">
    <img src="/2.0/images/logo.png" alt="Morphia Logo"/>
</a>
<span id="version-tag">Morphia 2.0</span>

    </div>
    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/2.0/getting-started/" title="Getting Started" class="dd-item 
        
        
        
        ">
      <a href="/2.0/getting-started/">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/2.0/getting-started/installation-guide/" title="Installation Guide" class="dd-item ">
        <a href="/2.0/getting-started/installation-guide/">
        Installation Guide
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0/getting-started/quick-tour/" title="Quick Tour" class="dd-item ">
        <a href="/2.0/getting-started/quick-tour/">
        Quick Tour
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0/getting-started/migration/" title="Migration Guide" class="dd-item ">
        <a href="/2.0/getting-started/migration/">
        Migration Guide
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/2.0/guides/" title="Reference Guides" class="dd-item 
        parent
        
        
        ">
      <a href="/2.0/guides/">
          Reference Guides
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/2.0/guides/annotations/" title="Annotations" class="dd-item ">
        <a href="/2.0/guides/annotations/">
        Annotations
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0/guides/aggregation/" title="Aggregation" class="dd-item ">
        <a href="/2.0/guides/aggregation/">
        Aggregation
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0/guides/indexing/" title="Indexing" class="dd-item active">
        <a href="/2.0/guides/indexing/">
        Indexing
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0/guides/jrebel/" title="JRebel" class="dd-item ">
        <a href="/2.0/guides/jrebel/">
        JRebel
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0/guides/lifecyclemethods/" title="Life Cycle Methods" class="dd-item ">
        <a href="/2.0/guides/lifecyclemethods/">
        Life Cycle Methods
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0/guides/querying/" title="Querying" class="dd-item ">
        <a href="/2.0/guides/querying/">
        Querying
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0/guides/references/" title="References" class="dd-item ">
        <a href="/2.0/guides/references/">
        References
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0/guides/schemavalidation/" title="Schema Validation" class="dd-item ">
        <a href="/2.0/guides/schemavalidation/">
        Schema Validation
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0/guides/transactions/" title="Transactions" class="dd-item ">
        <a href="/2.0/guides/transactions/">
        Transactions
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0/guides/updating/" title="Updating" class="dd-item ">
        <a href="/2.0/guides/updating/">
        Updating
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0/guides/validationextension/" title="Validation Extension" class="dd-item ">
        <a href="/2.0/guides/validationextension/">
        Validation Extension
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="/2.0/javadoc"><i class='fas fa-book'></i> API Documentation</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://github.com/MorphiaOrg/morphia"><i class='fab fa-fw fa-github'></i> Source Code</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      
    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/2.0/'>Morphia</a> > <a href='/2.0/guides/'>Reference Guides</a> > Indexing
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#class-level-indexes">Class Level Indexes</a>
<ul>
<li><a href="#fields">Fields</a>
<ul>
<li><a href="#value">value()</a></li>
<li><a href="#type">type()</a></li>
<li><a href="#weight">weight()</a></li>
</ul></li>
<li><a href="#index-options">Index Options</a>
<ul>
<li><a href="#background">background()</a></li>
<li><a href="#disablevalidation">disableValidation()</a></li>
<li><a href="#dropdups">dropDups()</a></li>
<li><a href="#expireafterseconds">expireAfterSeconds()</a></li>
<li><a href="#language">language()</a></li>
<li><a href="#languageoverride">languageOverride()</a></li>
<li><a href="#name">name()</a></li>
<li><a href="#sparse">sparse()</a></li>
<li><a href="#unique">unique()</a></li>
<li><a href="#partialfilter">partialFilter()</a></li>
<li><a href="#collation">collation()</a></li>
</ul></li>
</ul></li>
<li><a href="#field-level-indexes">Field Level Indexes</a></li>
<li><a href="#text-indexing">Text Indexing</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Indexing</h1>
          

        




<p>Morphia provides annotations that allow developers to define indexes for a collection to be defined alongside the other mapping data on
an entity&rsquo;s source.  In addition to the familiar ascending/descending index types, Morphia and MongoDB support <a href="http://docs.mongodb.org/manual/core/index-ttl/
">TTL</a>, <a href="http://docs.mongodb.org/manual/core/index-text/
">text</a>, and <a href="http://docs.mongodb.org/manual/applications/geospatial-indexes/
">geospatial</a>
 indexes.   When defining <a href="#text-indexing">text</a> indexes there are certain restrictions which will be covered below.  Full
  details for all these types are available in the <a href="http://docs.mongodb.org/manual/indexes
">manual</a>.</p>

<p>There are two ways to define indexes:  at the class level and at the field level.</p>

<h2 id="class-level-indexes">Class Level Indexes</h2>

<p>Class level indexing begins with the <a href="/2.0/guides/annotations/#indexes"><code>@Indexes</code></a> annotation.  This is a container
annotation whose sole purpose is to hold a number of <a href="/2.0/guides/annotations/#index"><code>@Index</code></a> annotations.  This annotation
has two primary components to cover here:  <code>fields</code> and <code>options</code>.  An index definition would take the following form:</p>

<pre><code class="language-java">@Entity
@Indexes({
    @Index(fields = @Field(value = &quot;field2&quot;, type = DESC)),
    @Index(
      fields = @Field(&quot;field3&quot;),
      options = @IndexOptions(name = &quot;indexing_test&quot;)
    )
})
public class IndexExample {
    @Id
    private ObjectId id;
    private String field;
    @Property
    private String field2;
    @Property(&quot;f3&quot;)
    private String field3;
}
</code></pre>

<h3 id="fields">Fields</h3>

<p>The fields to use in an index definition are defined with the <a href="/2.0/guides/annotations/#field"><code>@Field</code></a> annotation. An
arbitrary number of <a href="/2.0/javadoc?dev/morphia/annotations/Field.html
"><code>@Field</code></a>s can be given but at least one must be present.</p>

<h4 id="value">value()</h4>

<p>Indicates which field to use for indexing.  The name used for the field can be either the Java field name or the mapped document field
name as defined in the class&rsquo;s mapping via, e.g.,  the <a href="/2.0/guides/annotations/#property"><code>@Property</code></a> or
 <a href="/2.0/guides/annotations/#embedded"><code>@Embedded</code></a> annotations.  For most index types, this value is validated by default.  An
  exception is made for <a href="#text-indexing">text indexes</a> as discussed below.</p>

<h4 id="type">type()</h4>

<p><em>Default: IndexType.ASC</em></p>

<p>Indicates the &ldquo;type&rdquo; of the index (ascending, descending, geo2D, geo2d sphere, or text) to create on the field.</p>

<p><em>See <a href="/javadoc/dev/morphia/utils/IndexType.html">IndexType</a></em></p>

<h4 id="weight">weight()</h4>

<p><em>Optional</em></p>

<p>Specifies the weight to use when creating a text index.  This value only makes sense when direction is <code>IndexType.TEXT</code>.</p>

<h3 id="index-options">Index Options</h3>

<p>Options for an index are defined on the <a href="/2.0/guides/annotations/#indexoptions"><code>@IndexOptions</code></a>.  More complete coverage can
be found in the <a href="http://docs.mongodb.org/manual/reference/method/db.collection.createIndex/#options
">manual</a> but we&rsquo;ll provide some basic coverage
here as well.</p>

<h4 id="background">background()</h4>

<p><em>Default: false</em></p>

<p>This value determines if the index build is a blocking call or not.  By default, creating an index blocks all other operations on a
database.  When building an index on a collection, the database that holds the collection is unavailable for read or write operations
until the index build completes. For potentially long running index building operations, consider the <strong>background</strong> operation so that the
MongoDB database remains available during the index building operation.  The MongoDB <a href="http://docs.mongodb.org/manual/core/index-creation/#background-construction
">manual</a> has more detail.</p>

<h4 id="disablevalidation">disableValidation()</h4>

<p><em>Default: false</em></p>

<p>When ensuring indexes in the database, Morphia will attempt to ensure that the field names match either the Java field names or the
mapped document names.  Setting this to <code>true</code> disables this validation.</p>

<h4 id="dropdups">dropDups()</h4>

<p><em>Default: false</em></p>

<p>When defining a <a href="#unique">unique</a> index, if there are duplicate values found, the index creation will.  Setting this value to true will instruct MongoDB to drop the documents with duplicate values.</p>

<div class="admonition important">
<h5 class="admonition-title">important</h5>
<p>As of MongoDB version 3.0, the dropDups option is no longer available.</p>

</div>

<h4 id="expireafterseconds">expireAfterSeconds()</h4>

<p><em>Optional</em></p>

<p>Specifies a value, in seconds, as a <a href="http://docs.mongodb.org/manual/core/index-ttl/
">TTL</a> to control how long MongoDB retains documents in
this collection.  The field listed must contain values that are dates.</p>

<h4 id="language">language()</h4>

<p><em>Optional</em></p>

<p>For <a href="#text-indexing">text indexes</a>, the language that determines the list of stop words and the rules for the stemmer and
tokenizer. See <a href="http://docs.mongodb.org/manual/reference/text-search-languages/
">Text Search Languages</a> for the available languages and <a href="http://docs.mongodb.org/manual/tutorial/specify-language-for-text-index
">Specify a
Language for Text Index</a> for more information and examples. The default value
 is <strong>english</strong>.</p>

<h4 id="languageoverride">languageOverride()</h4>

<p><em>Optional</em></p>

<p>For <a href="#text-indexing">text indexes</a>, the name of the field in the collection’s documents that contains the
override language for the document. The default value is <strong>language</strong>. See <a href="http://docs.mongodb.org/manual/tutorial/specify-language-for-text-index/#specify-language-field-text-index-example
">Use any Field to Specify the Language for a Document</a> for an example.</p>

<h4 id="name">name()</h4>

<p><em>Optional</em></p>

<p>The name of the index. If unspecified, MongoDB generates an index name by concatenating the names of the indexed fields and
the sort order.</p>

<p>Whether user specified or MongoDB generated, index names including their full namespace (i.e. database.collection) cannot be longer than
 the <a href="http://docs.mongodb.org/manual/reference/limits/#Index-Name-Length
">Index Name Limit</a>.</p>

<h4 id="sparse">sparse()</h4>

<p><em>Default: false</em></p>

<p>If <code>true</code>, the index only references documents with the specified field. These indexes use less space but behave differently in
some situations (particularly sorts).  See <a href="http://docs.mongodb.org/manual/core/index-sparse/
">Sparse Indexes</a> for more
information.</p>

<h4 id="unique">unique()</h4>

<p><em>Default: false</em></p>

<p>Creates a unique index so that the collection will not accept insertion of documents where the index key or keys match an
existing value in the index.  Specify <code>true</code> to create a unique index.</p>

<h4 id="partialfilter">partialFilter()</h4>

<p><em>Optional</em></p>

<p>New in MongoDB 3.2, <a href="https://docs.mongodb.com/v3.2/core/index-partial/">partial indexes</a> only index the documents in a collection that meet
 a specified filter expression thereby reducing storage and maintenance costs.  A partial filter is defined using a query as shown here:</p>

<pre><code class="language-java">@Indexes({@Index(options = @IndexOptions(partialFilter = &quot;{ name : { $exists : true } }&quot;),
        fields = {@Field(value = &quot;name&quot;)})})
    public static class SomeClass { ... }
</code></pre>

<h4 id="collation">collation()</h4>

<p><em>Optional</em></p>

<p>Collation allows users to specify language-specific rules for string comparison, such as rules for lettercase and accent marks.  A collation
can be defined using the <code>collation()</code> property on <a href="/2.0/javadoc?dev/morphia/annotations/IndexOptions.html
"><code>@IndexOptions</code></a> and takes an <a href="/2.0/guides/annotations/#collation"><code>@Collation</code></a>
instance.</p>

<h2 id="field-level-indexes">Field Level Indexes</h2>

<p>Field level indexing is a simpler approach to defining a basic, single key index.  These indexes are defined by applying the
<a href="/2.0/guides/annotations/#indexed"><code>@Indexed</code></a> annotation to a particular field on a class.  Because the index definition is
applied at the field level, the index is created using only that field and so the <a href="/2.0/guides/annotations/#field"><code>@Field</code></a>
annotations are unnecessary.  The options for the index are the same as defined <a href="#options">above</a>.  A field level index
definition would look like this:</p>

<pre><code class="language-java">@Entity
private class FieldIndex {
    @Id
    private ObjectId id;
    @Indexed(options = @IndexOptions(unique = true))
    private String name;
    private String color;
}
</code></pre>

<h2 id="text-indexing">Text Indexing</h2>

<p>Morphia&rsquo;s indexing supports MongoDB&rsquo;s text indexing and search functionality as we&rsquo;ve briefly seen above.  Full details can be found in
the <a href="http://docs.mongodb.org/manual/core/index-text/
">manual</a> but there are a few Morphia specific details to cover.  Indexed field names are validated
by default but validation is disabled when an index is defined using MongoDB&rsquo;s
<a href="http://docs.mongodb.org/manual/core/index-text/#text-index-wildcard
"><code>$**</code></a> syntax.  This special instruction tells MongoDB to create a text index on
all fields with string content in a document.  A <a href="http://docs.mongodb.org/manual/core/index-text/#compound-index
">compound index</a> can be created
incorporating a text index but it&rsquo;s important to note there can only be one text index on a collection.</p>

<p>A wild card text index declaration would look like this:</p>

<pre><code class="language-java">    @Indexes(@Index(fields = @Field(value = &quot;$**&quot;, type = TEXT)))
</code></pre>

<div class="admonition important">
<h5 class="admonition-title">important</h5>
<p>A collection can have at most one text index.</p>

</div>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/2.0/guides/aggregation/" title="Aggregation"> <i class="fas fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/2.0/guides/jrebel/" title="JRebel" style="margin-right: 0px;"><i class="fas fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/2.0/js/clipboard.min.js?1583121132"></script>
    <script src="/2.0/js/perfect-scrollbar.min.js?1583121132"></script>
    <script src="/2.0/js/perfect-scrollbar.jquery.min.js?1583121132"></script>
    <script src="/2.0/js/jquery.sticky.js?1583121132"></script>
    <script src="/2.0/js/featherlight.min.js?1583121132"></script>
    <script src="/2.0/js/html5shiv-printshiv.min.js?1583121132"></script>
    <script src="/2.0/js/highlight.pack.js?1583121132"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/2.0/js/modernizr.custom.71422.js?1583121132"></script>
    <script src="/2.0/js/learn.js?1583121132"></script>
    <script src="/2.0/js/hugo-learn.js?1583121132"></script>

    <link href="/2.0/mermaid/mermaid.css?1583121132" type="text/css" rel="stylesheet" />
    <script src="/2.0/mermaid/mermaid.js?1583121132"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

